# AI 보안 인시던트 대응 가이드

<!-- jinhak_standard_version: 2.0 -->
<!-- document_type: security-incident-response -->
<!-- last_updated: 2026-02-20 -->

---

## 1. 개요

이 문서는 AI(Claude Code) 협업 환경에서 발생할 수 있는 **보안 인시던트의 분류, 대응 절차, 보고 체계**를 정의합니다.

**목적:**
- AI 보안 인시던트 발생 시 신속하고 체계적인 대응
- 인시던트 심각도에 따른 명확한 SLA 및 에스컬레이션 경로 제공
- 사후 분석을 통한 재발 방지 체계 구축

**적용 범위:**
- AI(Claude Code) 세션에서 발생하는 모든 보안 이벤트
- NightBuilder 자동 개발 환경의 보안 이벤트
- AI가 생성한 코드로 인해 발생하는 보안 취약점

---

## 2. 심각도 분류

| Level | 설명 | 대응 SLA | 예시 |
|-------|------|----------|------|
| **P1-Critical** | 개인정보 유출, 프로덕션 침해 | **즉시 (1시간 이내)** | AI가 실제 수험생 데이터를 외부로 전송, 프로덕션 DB 직접 조작 발생 |
| **P2-High** | 보안 취약점 배포, 시크릿 노출 | **4시간 이내** | SQL Injection 코드가 프로덕션에 배포됨, API Key가 커밋에 포함됨 |
| **P3-Medium** | 보안 규칙 위반, 미승인 접근 | **24시간 이내** | AI가 금지된 파일에 접근 시도, deny 규칙 우회 시도 탐지 |
| **P4-Low** | 경미한 규칙 위반 | **다음 스프린트** | 커밋 메시지 규칙 미준수, 코딩 컨벤션 위반 |

### 심각도 판단 기준

```
P1 판단 기준 (하나라도 해당 시):
├── 실제 개인정보(수험생 데이터)가 외부에 노출됨
├── 프로덕션 시스템이 침해됨
├── 결제 관련 데이터가 유출됨
└── 서비스 전체 장애 발생

P2 판단 기준 (하나라도 해당 시):
├── 보안 취약점이 포함된 코드가 프로덕션에 배포됨
├── 시크릿(API Key, 비밀번호)이 Git에 커밋됨
├── 금지 패턴(CRITICAL 등급)이 탐지 없이 통과됨
└── NightBuilder가 허용 범위를 벗어난 작업 수행

P3 판단 기준:
├── AI가 deny 규칙에 의해 차단된 명령을 시도함
├── 보안 스캔에서 HIGH 이상 취약점 탐지됨
├── 민감 파일에 대한 비인가 접근 시도
└── 보안 정책 위반이 코드 리뷰에서 발견됨

P4 판단 기준:
├── 커밋 메시지 형식 미준수
├── 코딩 컨벤션 경미한 위반
├── 비필수 보안 권고 미이행
└── 문서 업데이트 누락
```

---

## 3. 대응 절차

### 3.1 대응 흐름 개요

```
탐지 (Detection)
    │
    ▼
격리 (Containment)
    │
    ▼
분석 (Analysis)
    │
    ▼
복구 (Recovery)
    │
    ▼
사후 검토 (Post-Incident Review)
```

### 3.2 단계별 상세 절차

#### 단계 1: 탐지 (Detection)

**자동 탐지:**
- Claude Code Hooks(PreToolUse)에서 금지 패턴 탐지
- settings.json deny 규칙에 의한 명령 차단
- CI/CD 파이프라인의 보안 스캔(ESLint, Semgrep, npm audit)
- NightBuilder 모니터링 시스템의 이상 행동 감지

**수동 탐지:**
- 코드 리뷰 과정에서 보안 취약점 발견
- 팀원의 보안 이슈 보고
- 외부 취약점 보고 (보안 리서처, 사용자)

#### 단계 2: 격리 (Containment)

**즉시 조치 (P1/P2):**
1. **AI 세션 즉시 종료** - 진행 중인 Claude Code 세션 중단
2. **영향 범위 파악** - 어떤 파일, 브랜치, 서비스가 영향을 받았는지 확인
3. **관련 브랜치 잠금** - 해당 브랜치에 대한 추가 커밋/머지 차단
4. **프로덕션 격리** (P1인 경우) - 영향받은 서비스 롤백 또는 격리

**일반 조치 (P3/P4):**
1. 해당 작업 중단
2. 보안 이벤트 로그 기록
3. 관련 담당자에게 알림

#### 단계 3: 분석 (Analysis)

**조사 항목:**
- AI 세션 로그 확인 (실행된 명령어, 접근한 파일)
- Git 히스토리 분석 (영향받은 커밋 식별)
- 보안 스캔 결과 검토
- 근본 원인(Root Cause) 파악

**분석 질문:**
1. 어떤 보안 규칙이 실패했는가?
2. 기존 방어 레이어(7-Layer) 중 어느 부분이 미흡했는가?
3. 의도적 공격인가, 실수인가, AI 환각(hallucination)인가?
4. 영향 범위는 어디까지인가?

#### 단계 4: 복구 (Recovery)

**P1/P2 복구 절차:**
1. 취약한 코드가 포함된 커밋 되돌리기 (`git revert`)
2. 노출된 시크릿 즉시 교체 (API Key, 비밀번호 등)
3. 보안 패치 적용 및 재배포
4. 영향받은 사용자 알림 (P1의 경우 법적 의무 확인)

**P3/P4 복구 절차:**
1. 해당 코드 수정 및 커밋
2. 보안 규칙 업데이트 (필요 시)
3. 관련 문서 업데이트

#### 단계 5: 사후 검토 (Post-Incident Review)

**검토 항목:**
- 타임라인 정리 (발생 → 탐지 → 격리 → 복구 시간)
- 근본 원인 분석 결과
- 방어 레이어 개선 사항
- 재발 방지 대책

**검토 시기:**
- P1: 복구 완료 후 24시간 이내
- P2: 복구 완료 후 1주일 이내
- P3: 다음 정기 미팅에서
- P4: 스프린트 회고에서

---

## 4. 심각도별 상세 대응 절차

### P1-Critical 대응

```
[0분]  인시던트 탐지
[5분]  AI 세션 종료 + 초기 격리
[15분] 팀 리드 + 보안 담당자 + CTO에게 즉시 알림
[30분] 영향 범위 1차 파악 + 프로덕션 격리 조치
[1시간] 1차 보고서 작성 + 개인정보 유출 시 법적 의무 확인
[4시간] 복구 완료 목표
[24시간] 사후 검토 미팅
[1주일] 최종 보고서 + 재발 방지 대책 시행
```

### P2-High 대응

```
[0분]   인시던트 탐지
[15분]  AI 세션 종료 + 관련 브랜치 잠금
[30분]  팀 리드 + 보안 담당자에게 알림
[1시간] 영향 범위 파악 + 취약 코드 식별
[4시간] 복구 완료 목표 (코드 되돌리기 + 시크릿 교체)
[1주일] 사후 검토 + 보안 규칙 업데이트
```

### P3-Medium 대응

```
[0분]   인시던트 탐지 및 로그 기록
[1시간] 팀 리드에게 알림
[4시간] 원인 분석
[24시간] 수정 완료 + 보안 규칙 점검
[1주일] 정기 미팅에서 공유
```

### P4-Low 대응

```
[0분]     인시던트 기록
[스프린트] 다음 스프린트 백로그에 추가
[회고]    스프린트 회고에서 공유 및 개선
```

---

## 5. 보고서 템플릿

```markdown
# AI 보안 인시던트 보고서

## 기본 정보
- **인시던트 번호**: INC-YYYY-NNN
- **발생 일시**: YYYY-MM-DD HH:MM (KST)
- **탐지 일시**: YYYY-MM-DD HH:MM (KST)
- **심각도**: P1 / P2 / P3 / P4
- **상태**: 조사 중 / 격리 완료 / 복구 완료 / 종결
- **보고자**: (이름, 직책)

## 영향 범위
- **영향받은 시스템**: (서비스명, 환경)
- **영향받은 데이터**: (데이터 유형, 건수)
- **영향받은 사용자**: (사용자 유형, 수)

## 인시던트 요약
(인시던트의 간략한 설명 - 무엇이, 언제, 어떻게 발생했는지)

## 타임라인
| 시각 | 이벤트 |
|------|--------|
| HH:MM | 인시던트 발생 |
| HH:MM | 탐지 |
| HH:MM | 격리 조치 |
| HH:MM | 복구 완료 |

## 원인 분석
### 직접 원인
(인시던트를 직접적으로 발생시킨 원인)

### 근본 원인
(근본적인 원인 - 프로세스, 시스템, 인적 요인)

### 7-Layer 분석
(어느 방어 레이어에서 실패했는지)

## 조치 내역
1. (수행한 격리/복구 조치 1)
2. (수행한 격리/복구 조치 2)

## 재발 방지 대책
| 대책 | 담당자 | 기한 | 상태 |
|------|--------|------|------|
| (대책 1) | (담당자) | (기한) | 진행 중 / 완료 |
| (대책 2) | (담당자) | (기한) | 진행 중 / 완료 |

## 승인
- **작성자**: (이름) / (일자)
- **검토자**: (이름) / (일자)
- **승인자**: (이름) / (일자)
```

---

## 6. 연락망

### 에스컬레이션 경로

```
개발자 (인시던트 발견)
    │
    ├── P4: 스프린트 백로그에 등록
    │
    ├── P3: 팀 리드에게 보고
    │       └── 보안 담당자에게 알림 (필요 시)
    │
    ├── P2: 팀 리드 + 보안 담당자에게 즉시 보고
    │       └── CTO에게 알림
    │
    └── P1: 팀 리드 + 보안 담당자 + CTO에게 즉시 보고
            └── 법무/컴플라이언스 팀 알림 (개인정보 유출 시)
```

### 역할별 연락 체계

| 역할 | 책임 | 연락 수단 | 응답 SLA |
|------|------|----------|----------|
| **개발자** | 인시던트 초기 탐지 및 보고, 1차 격리 | 사내 메신저 + 전화 | 즉시 |
| **팀 리드** | 에스컬레이션 판단, 팀 대응 조율 | 사내 메신저 + 전화 | 15분 |
| **보안 담당자** | 보안 분석, 격리/복구 지원, 보고서 작성 | 사내 메신저 + 전화 + 이메일 | P1: 30분, P2: 1시간 |
| **CTO** | P1 최종 의사결정, 대외 커뮤니케이션 | 전화 + 이메일 | P1: 1시간 |
| **법무/컴플라이언스** | 법적 의무 확인, 규제 기관 보고 | 이메일 + 전화 | P1: 2시간 |

---

## 7. 관련 문서 참조

| 문서 | 설명 |
|------|------|
| [AI_SECURITY_GUARDRAILS.md](./AI_SECURITY_GUARDRAILS.md) | 7-Layer Defense 마스터 문서 |
| [FORBIDDEN_PATTERNS.md](./FORBIDDEN_PATTERNS.md) | AI 금지 코드 패턴 카탈로그 |
| [DATA_CLASSIFICATION.md](./DATA_CLASSIFICATION.md) | 데이터 분류 및 처리 기준 |
| [NIGHTBUILDER_SECURITY.md](./NIGHTBUILDER_SECURITY.md) | NightBuilder 보안 규칙 |
| [../SECURITY_ISMS.md](../SECURITY_ISMS.md) | ISMS 보안 가이드 |

---

*이 문서는 [JINHAK 전사 AI 개발 표준](../CLAUDE.md) v2.0의 보안 상세 문서입니다.*
