---
name: session-end
description: 세션 종료 시 작업 기록을 정리하고 다음 세션을 위한 컨텍스트를 저장
---

세션을 종료하며 작업 기록을 자동으로 정리합니다.

## 실행 절차

### 1단계: 변경사항 수집
1. `git diff --name-only` + `git diff --cached --name-only`로 변경된 파일 목록 수집
2. `git log --oneline` 로 이번 세션의 커밋 목록 확인 (SESSION_LOG 마지막 기록 날짜 이후)
3. 미커밋 변경사항이 있으면 커밋 여부를 사용자에게 확인

### 2단계: SESSION_LOG.md 업데이트
오늘 날짜 섹션이 이미 있으면 내용을 보완, 없으면 새로 생성:

```markdown
## YYYY-MM-DD

### 세션 작업 요약
- [이번 세션에서 수행한 주요 작업 자동 요약]

### 주요 변경
- `파일경로` - 변경 내용

### 커밋
- `해시` 커밋 메시지
```

### 3단계: CURRENT_SPRINT.md 업데이트
1. 완료된 작업을 "최근 완료" 섹션으로 이동
2. "마지막 업데이트" 날짜 갱신
3. 새로 발견된 작업이 있으면 "대기 중"에 추가

### 4단계: Auto Memory 업데이트
이번 세션에서 발견된 안정적인 패턴, 인사이트, 의사결정이 있으면 Memory에 기록합니다.

**체크리스트:**
- [ ] 새로 확인된 패턴/컨벤션 → `memory/patterns.md`에 추가
- [ ] 반복 문제 해결책 → `memory/debugging.md`에 추가
- [ ] 아키텍처 결정 → `memory/architecture.md`에 추가
- [ ] 사용자 워크플로우 선호 → `memory/MEMORY.md`에 추가
- [ ] 이번 세션에 `/deep-plan` 사용 작업이 있는가?
  → `.ai/DECISIONS.md`의 해당 `DP-NNN` 기록에 "구현 후 실제 이슈" 업데이트
  → 계획대로 구현되었는지, 예상치 못한 이슈, 비평에서 놓친 점 기록

**기록 규칙:**
- `MEMORY.md`는 **200줄 이내** 유지 (초과 시 서브파일로 분리)
- `CLAUDE.md`에 이미 있는 규칙과 **중복 금지**
- 단일 세션에서만 확인된 미검증 정보는 기록하지 않음
- 세션별 맥락(현재 작업 상태, 임시 정보)은 `.ai/` 폴더에 기록, Memory에는 기록하지 않음

### 5단계: 종료 브리핑
사용자에게 다음을 요약 보고:
- 이번 세션 작업 요약
- 커밋 현황 (총 N개 커밋)
- 미완료 작업 (있으면)
- 다음 세션 권장 작업

## 주의사항
- SESSION_LOG.md 기존 내용을 절대 삭제하지 않음 (추가만)
- CURRENT_SPRINT.md 기존 구조를 유지하며 업데이트
- 커밋되지 않은 변경사항 처리를 사용자에게 반드시 확인
